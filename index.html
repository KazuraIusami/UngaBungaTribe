<html>
	<!-- Current project is a time based day/night cycle with day phase implimentation-->
<head>
	<title>UNGA - Powered by Aztech</title>

		<link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/KazuraIusami/UngaBungaTribe/main/UNGA.ico">
	<style>
  body {
  /*  transition: background-color 1s ease; */
	text-align: center;
    font-family: Arial, sans-serif;
    font-size: 24px;
    padding-top: 100px;
  }

</style>
</head>
<body>
		
		<input type="text" id="nameInput" placeholder="Enter a Name" style="text-align:center"><p id="name"></p> <button onclick="submitName()" id="submitButton">Submit</button>
	  <div id="dayDisplay">Day : 0 </div>
	  <div id="timeDisplay">Time: 00:00</div>
	  <div id="phaseDisplay">Phase : Midnight</div>
	  
	  <button onclick="toggleInterval()">Pause/Resume</button>
	  <button onclick="save()">Save!</button>
	  <button onclick="load()">Load!</button>
	  <button onclick="deleteSave()">Delete Save (ALL progress will be lost)</button>
	  <br>
	  <div id="hungerDiv">Hunger : 1000</div>
	  <button onclick="hunger=hunger+50">Eat (+50 Hunger)</button>
	  

  
  <script>
	let name;
	
	let day = 0;
	let time = 720; // Set initial time to 12:00 (720 minutes)
	const brightestTime = 840; // Set the brightest time to 14:00 (840 minutes)
	
	let phase = 'Midnight';
	let hours = Math.floor(time / 60);
    let minutes = time % 60;
    let formattedTime = `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes}`;
	
	//SURVIVAL STUFF
	let hunger = 1000;
	
	
function updateTime() {			//THIS IS THE SINGLE TICK FUNCTION
    time += 1;
	
    
	hours = Math.floor(time / 60);
	minutes = time % 60;
	formattedTime = `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes}`;
	
    document.getElementById('timeDisplay').textContent = `Time: ${formattedTime}`;
	document.getElementById('dayDisplay').textContent = `Day: ${day}`;
    
    let brightness;
    if (time < brightestTime) {
        brightness = time / brightestTime; // Brightness increases until the brightest time
    } else {
        brightness = 1 - (time - brightestTime) / (1440 - brightestTime); // Brightness decreases after the brightest time
    }
    
    const backgroundColor = `rgb(${brightness * 255 - 40}, ${brightness * 255 - 40}, ${brightness * 255 - 20})`;
    document.body.style.backgroundColor = backgroundColor;
	
	 // Calculate inverse color for text
    const inverseColor = `rgb(${255 - (brightness * 255 - 40)}, ${255 - (brightness * 255 - 40)}, ${255 - (brightness * 255 - 20)})`;
    document.body.style.color = inverseColor;
    
    if (time > 1440) {
        time = 0;
		day++;
		console.log("New Day! Day : " + day );
		document.getElementById('dayDisplay').textContent = `Day: ${day}`;
    }
	
	if(time < 119){							//00:00 -> 02:00
		phase = "Midnight";
	}else if(time > 119 && time < 359){		//02:00 -> 06:00
		phase = "Early Morning";
	}else if(time > 359 && time < 539){		//06:00 -> 09:00
		phase = "Morning";
	}else if(time > 539 && time < 719){		//09:00 -> 12:00
		phase = "Late Morning";
	}else if(time > 719 && time < 779){		//12:00 -> 13:00
		phase = "High Noon";
	}else if(time > 779 && time < 960){		//13:00 -> 16:00
		phase = "Afternoon";
	}else if(time > 960 && time < 1140){	//16:00 -> 19:00
		phase = "Late Afternoon";
	}else if(time > 1140 && time < 1320){ 	//19:00 -> 22:00
		phase = "Evening";
	}else if(time > 1320){					//22:00 -> 24:00
		phase = "Night";
	}
	document.getElementById("phaseDisplay").textContent = `Phase : ${phase}`;
	
	hunger--;
	let roundedHunger = Math.round(hunger / 25) * 25; // Round to nearest 25
	document.getElementById("hungerDiv").textContent = `Hunger : ${roundedHunger}`;
	
	if(hunger < 0){
		console.log("DIED! Day : " + day + " ( " + formattedTime + " )");
		console.log("Reloading to last save")
		load();
	}
	
	if(hunger > 2000){
		document.getElementById("hungerDiv").innerHTML += " (<.<) okay not judging but...";
		console.log("Silently Judging...");
	}
	
}


//Function to start and stop the interval
let tickInterval = setInterval(updateTime, 100);

function toggleInterval(){ //TOGGLE TIME INTERVAL
	if(!tickInterval){
		tickInterval = setInterval(updateTime, 100);
	}else {
		clearInterval(tickInterval);
		tickInterval = null;
	}
}

function submitName(){
	name = document.getElementById("nameInput").value;
	document.getElementById("name").textContent = `${name}`;
	document.getElementById("nameInput").style.display = "none";
	document.getElementById("submitButton").style.display = "none";
}

function save(){
	var currentSave = {SavedDay: day, SavedHour: hours, SavedMinute: minutes, SavedTime: time, SavedHunger: hunger, SavedName: name}; //ALL STUFF SAVED DURING SAVE
	var stringed = JSON.stringify(currentSave);
	localStorage.setItem("currentSaveStringed", stringed)
	console.log("Saved. " + stringed)
}

function load() {
    // Check if 'currentSaveStringed' exists in localStorage
    if (localStorage.getItem('currentSaveStringed')) {
        // Retrieve the value and set it to currentSave
        var currentSave = JSON.parse(localStorage.getItem('currentSaveStringed'));
		
			day = currentSave.SavedDay;
			hours = currentSave.SavedHour;
			minutes = currentSave.SavedMinute;
			time = currentSave.SavedTime;
			hunger = currentSave.SavedHunger;
			name = currentSave.SavedName;
				document.getElementById("name").textContent = `${name}`; //
        console.log('currentSave set to:', currentSave);
    } else {
        console.log('No current save found in localStorage.');
    }
}

load(); //we are talking, MEGA BRAIN 

function deleteSave(){
	localStorage.clear();
}

  </script>
</body>
</html>
