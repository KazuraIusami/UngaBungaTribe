<!DOCTYPE html>
<html lang="en">
<head>
	<title>UNGA - Powered by Aztech</title>
	<link rel="icon" type="image/x-icon" href="https://raw.githubusercontent.com/KazuraIusami/UngaBungaTribe/main/UNGA.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Context Window</title>
    <style>
.context-window {
    position: absolute;
    border: 1px solid black;
    background-color: white;
    z-index: 1000;
    width: auto;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
}


.context-window-title {
    background-color: #ccc;
    padding: 5px;
    cursor: move;
    font-weight: bold;
    border: 1px solid black;
}

.context-window-content {
    padding: 10px;
}
.bar-container {
    margin: 10px 0;
}

.bar-label {
    font-weight: bold;
    margin-bottom: 5px;
}

.bar {
    width: 100%;
    height: 20px;
    background-color: #ddd;
    border: 1px solid #aaa;
    position: relative;
}

.bar-fill {
    height: 100%;
    background-color: #4caf50;
    width: 0;
}

	</style>
</head>
<body>
    <script>
let zIndexCounter = 1000; // Global z-index counter

class ContextWindow {
    constructor(title, startX = 0, startY = 0) {
        this.div = document.createElement('div');
        this.div.className = 'context-window';
        this.div.style.left = `${startX}px`;
        this.div.style.top = `${startY}px`;
        this.div.style.zIndex = zIndexCounter++; // Set initial z-index

        this.titleBar = document.createElement('div');
        this.titleBar.className = 'context-window-title';
        this.titleBar.innerText = title;

        // Toggle visibility button
        this.toggleButton = document.createElement('button');
        this.toggleButton.innerText = 'X';
        this.toggleButton.className = 'context-window-toggle';
        this.toggleButton.onclick = () => this.toggleVisibility();
        this.titleBar.appendChild(this.toggleButton);
        this.titleBar.style.right = "5px";

        this.div.appendChild(this.titleBar);

        this.content = document.createElement('div');
        this.content.className = 'context-window-content';
        this.div.appendChild(this.content);

        // New div for buttons
        this.buttonContainer = document.createElement('div');
        this.buttonContainer.className = 'context-window-buttons';
        this.div.appendChild(this.buttonContainer);

        // Divs for different levels
        this.buttonLevels = [];
        for (let i = 0; i < 5; i++) {
            let levelDiv = document.createElement('div');
            levelDiv.className = `button-level-${i + 1}`;
            this.buttonContainer.appendChild(levelDiv);
            this.buttonLevels.push(levelDiv);
        }

        document.body.appendChild(this.div);

        this.text = '';

        this.initDrag();
        this.initFocus();
    }

    setText(text) {
        this.text = text;
        this.content.innerHTML = this.text; // Only update text content
    }

    addButton(label, onClick, level = 1) {
        const button = document.createElement('button');
        button.innerText = label;
        button.onclick = onClick; // Assign the provided click handler
        // Append button to the appropriate level container
        if (level >= 1 && level <= 5) {
            this.buttonLevels[level - 1].appendChild(button);
        } else {
            this.buttonContainer.appendChild(button); // Default to main container if level is out of range
        }
    }
	

    initDrag() {
        this.titleBar.onmousedown = this.onMouseDown.bind(this);
    }

    onMouseDown(event) {
        event.preventDefault();
        this.offsetX = event.clientX - this.div.offsetLeft;
        this.offsetY = event.clientY - this.div.offsetTop;
        this.dragging = true;

        document.onmouseup = this.onMouseUp.bind(this);
        document.onmousemove = this.onMouseMove.bind(this);

        this.bringToFront(); // Bring window to front when clicked
    }

    onMouseUp(event) {
        this.dragging = false;
        document.onmouseup = null;
        document.onmousemove = null;
    }

    onMouseMove(event) {
        event.preventDefault();
        if (this.dragging) {
            this.div.style.left = (event.clientX - this.offsetX) + 'px';
            this.div.style.top = (event.clientY - this.offsetY) + 'px';
        }
    }

    initFocus() {
        this.div.onclick = this.bringToFront.bind(this);
    }

    bringToFront() {
        this.div.style.zIndex = zIndexCounter++;
    }

    toggleVisibility(option = "undefined") {
        if (option === "undefined") {
            if (this.div.style.display === 'none') {
                this.div.style.display = 'block';
            } else {
                this.div.style.display = 'none';
            }
        } else if (option === "visible") {
            this.div.style.display = 'block';
        } else if (option === "hidden") {
            this.div.style.display = 'none';
        }
    }

    setButtonVisibility(level, visible) {
        if (level >= 1 && level <= 5) {
            this.buttonLevels[level - 1].style.display = visible ? 'block' : 'none';
        }
    }
};



//TIME WINDOW AND FUNCTION
	let day = 0;
	let InGametime = 720; // Set initial time to 12:00 (720 minutes)
	let brightestTime = 840; // Set the brightest time to 14:00 (840 minutes)
	
	let phase = 'Midnight';
	let hours = Math.floor(InGametime / 60);
    let minutes = InGametime % 60;
    let formattedTime = `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes}`;
	
	function updateTime() {			//THIS IS THE SINGLE TICK TIME FUNCTION
		InGametime += 1;
		
		hours = Math.floor(InGametime / 60);
		minutes = InGametime % 60;
		formattedTime = `${hours < 10 ? '0' : ''}${hours}:${minutes < 10 ? '0' : ''}${minutes}`;
		
		
		let brightness;
		if (InGametime < brightestTime) {
			brightness = InGametime / brightestTime; // Brightness increases until the brightest time
		} else {
			brightness = 1 - (InGametime - brightestTime) / (1440 - brightestTime); // Brightness decreases after the brightest time
		}
		
		const backgroundColor = `rgb(${brightness * 255 - 40}, ${brightness * 255 - 40}, ${brightness * 255 - 20})`;
		document.body.style.backgroundColor = backgroundColor;
		
		 // Calculate inverse color for text
		const inverseColor = `rgb(${255 - (brightness * 255 - 40)}, ${255 - (brightness * 255 - 40)}, ${255 - (brightness * 255 - 20)})`;
		<!-- document.getElementById("timeDiv").style.color = inverseColor; -->
		
		if (InGametime > 1440) {
			let diff = InGametime - 1440;
			console.log(diff);
			InGametime = 0;
			day++;
			console.log("New Day! Day : " + day );
			
		}
		
										if(InGametime < 119){							//00:00 -> 02:00
											phase = "Midnight";
										}else if(InGametime > 119 && InGametime < 359){		//02:00 -> 06:00
											phase = "Early Morning";	
										}else if(InGametime > 359 && InGametime < 539){		//06:00 -> 09:00
											phase = "Morning";
										}else if(InGametime > 539 && InGametime < 719){		//09:00 -> 12:00
											phase = "Late Morning";
										}else if(InGametime > 719 && InGametime < 779){		//12:00 -> 13:00
											phase = "High Noon";
										}else if(InGametime > 779 && InGametime < 960){		//13:00 -> 16:00
											phase = "Afternoon";
										}else if(InGametime > 960 && InGametime < 1080){	//16:00 -> 18:00
											phase = "Late Afternoon";
										}else if(InGametime > 1080 && InGametime < 1320){ 	//18:00 -> 22:00
											phase = "Evening";
										}else if(InGametime > 1320){					//22:00 -> 24:00
											phase = "Night";
										}
		
	}



	let tickTime = 100;

	let tickInterval = setInterval(updateTime, tickTime); //tickTime = ms


// New Context Window for Time and Date
const timeWindow = new ContextWindow('Time and Date', 0, 0);

let currentdate = new Date();
let sessionStartTime = new Date();
let lastLogOffTime = sessionStartTime;

function updateRealTime() {
    currentdate = new Date();
    let currentTimeText = "Current Local Time: " + currentdate.toLocaleString();

    // Update time in current session
    let sessionTimeElapsed = currentdate - sessionStartTime;
    let sessionSeconds = Math.floor(sessionTimeElapsed / 1000);
    let sessionMinutes = Math.floor(sessionSeconds / 60);
    let sessionHours = Math.floor(sessionMinutes / 60);
    let sessionDisplayTime = `${sessionHours} hours, ${sessionMinutes % 60} minutes, and ${sessionSeconds % 60} seconds`;
    let sessionTimeText = "Time in Current Session: " + sessionDisplayTime;

    // Display last save time
    let lastSaveText = loadLastSave();

    // Display last log off time
    let lastLogOffText = getLastLogOffTime();

    // Update the content of the context window
    timeWindow.setText(`${currentTimeText}<br>${lastSaveText}<br>${sessionTimeText}<br>${lastLogOffText} <br><hr> INGAME TIME :  ${formattedTime} <br> Day : ${day} <br> Phase : ${phase}`);
}

function loadLastSave() {
    if (localStorage.getItem('currentSaveStringed')) {
        let savedData = JSON.parse(localStorage.getItem('currentSaveStringed'));

        // Last save time
        let lastSavedTime = new Date(savedData.lastCurrentTime);
        let timeDifference = currentdate - lastSavedTime;
        let diffSeconds = Math.floor(timeDifference / 1000);
        let diffMinutes = Math.floor(diffSeconds / 60);
        let diffHours = Math.floor(diffMinutes / 60);
        return `Last Save: ${lastSavedTime.toLocaleString()} (about ${diffHours} hours, ${diffMinutes % 60} minutes, and ${diffSeconds % 60} seconds ago)`;
    } else {
        return "No previous save found.";
    }
}

function getLastLogOffTime() {
    if (lastLogOffTime && lastLogOffTime < sessionStartTime) {
        let timeDifference = currentdate - lastLogOffTime;
        let diffSeconds = Math.floor(timeDifference / 1000);
        let diffMinutes = Math.floor(diffSeconds / 60);
        let diffHours = Math.floor(diffMinutes / 60);
        return `Last Log Off: ${lastLogOffTime.toLocaleString()} (about ${diffHours} hours, ${diffMinutes % 60} minutes, and ${diffSeconds % 60} seconds ago)`;
    } else {
        return "No previous log off found.";
    }
}

function save() {
    let currentSave = { lastCurrentTime: currentdate }; // Save the current time
    let stringed = JSON.stringify(currentSave);
    localStorage.setItem("currentSaveStringed", stringed);
}

function deleteSave() {
    localStorage.clear();
    location.reload();
}

// Run load function when page loads
window.onload = () => {
    loadLastSave();
    if (localStorage.getItem('lastLogOffTime')) {
        lastLogOffTime = new Date(localStorage.getItem('lastLogOffTime'));
    }
};

// Autosave every 10 seconds
let saveInterval = setInterval(save, 100);

// Update time display every second
let timeInterval = setInterval(updateRealTime, 128);

// Save the log off time when the window is unloaded
window.onbeforeunload = () => {
    localStorage.setItem('lastLogOffTime', currentdate);
};

let SnakesWords = "Say, you look mighty hungry! Care for some...forbidden fruit?";

	let SnakeWindow = new ContextWindow("Snake", window.innerWidth / 2.5, window.innerHeight / 4);
	SnakeWindow.setText("<pre>  <br>"+                                                                                                 
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                                                                <br>"+
	"                      #+---+#-..+--+#                           <br>"+
	"                   ##+-+-.--.....--+.#+++####                   <br>"+
	"             ###--.+#+#.#+. ... ...+##++-.-...##                <br>"+
	"          ###+--.-.+-+-##0##..----##0#$++---+--.-##              <br>"+
	"         #+++.-.-++#.+.-..--.-..--+---+####+--+--#              <br>"+
	"         ###+..+--.-#.+#++-.-    -.+#.#+-+-++--..##             <br>"+
	"       #####--..-.-..+##++#.-+##--+##+-.+--....-+#              <br>"+
	"      #-----##-+++----+-+#+--+#+##+------.-.-.-###              <br>"+
	"     ##+--.--+###+++-----------------------+#######             <br>"+
	"     ##-. .....-.+.--+###++-++++#############+#+#+-##           <br>"+
	"     ##+--....---.+.-.-..--.--------.----..---+--.++#           <br>"+
	"      ###++----.-.--..----.--.--.-.-..-.-..-.-.---+##           <br>"+
	"     #########++++---------.----.-.-.....-....-.-+######+       <br>"+
	"    #####################++--+--+--.+.--.---+++########-+##     <br>"+
	"         ############################################+##        <br>"+
	"                      #########################                 </pre>");

	SnakeWindow.addButton("Wake the snake", () => {
	setInterval( () => {
	SnakeWindow.setText("<pre> <br>"+      
	"															<br>"+   
	"                                                                <br>"+   
	"                                                                <br>"+   
	"                     ##-.-+##+-#++##                            <br>"+   
	"                    +---.--..-..----##                          " + SnakesWords + "<br>"+   
	"                   ##+-+#. .....-.-####                         <br>"+   
	"                  #----####.....-###+-+#                        <br>"+   
	"                  #.-.-.+++ -  -.##+.-##                        <br>"+   
	"                   #++#++-.-    -.-+++##                        <br>"+   
	"                    ###++#.--++++-#+##                          <br>"+   
	"                     ######+-++##+#                             <br>"+   
	"                     ###++##### ##-#                            <br>"+   
	"                     ###-..-+##  ##--####    ##                 <br>"+   
	"                      ##+....+#    ##############               <br>"+   
	"                      #+-.. ..+#      #########                 <br>"+   
	"                      #+-   ..+#                                <br>"+   
	"                      #-------+#                                <br>"+   
	"                      +-......-#                                <br>"+   
	"                     #--.-....+#                                <br>"+   
	"                    ##--.    .#----++--++####                   <br>"+   
	"             ##+#+--+++-...-+#+..---+----.-...##                <br>"+   
	"          ##+.-.--.-++---.-+++--.----------+--.-##              <br>"+   
	"         #+-.-.....#++.-..-+#----+++++#####+--+--#              <br>"+   
	"         ##++-+++-.#+#--++-##########++--+-++--..##             <br>"+   
	"       ####++.######+#--++#+.--.+--.-.-.+--....-+#              <br>"+   
	"      #-------++######--+++------+-------.-.-.-###              <br>"+   
	"     ##+--.-..-...-++###+##+----+----------+#######             <br>"+   
	"     ##-. .....-.+ ..-.--++##################+#+#+-##           <br>"+   
	"     ##+--....---.+.-.-..--.--------.----..---+--.++#           <br>"+   
	"      ###++----.-.--..----.--.--.-.-..-.-..-.-.---+##           <br>"+   
	"     #########++++---------.----.-.-.....-....-.-+######+       <br>"+   
	"    #####################++--+--+--.+.--.---+++########-+##     <br>"+   
	"         ############################################+##        <br>"+   
	"                      +######################+#+                </pre>");}, 16);
	SnakeWindow.setButtonVisibility(1, false);
	SnakeWindow.setButtonVisibility(2, true);
	
	ForbiddenFruitWindow.toggleVisibility("visible");
	}, 1);
SnakeWindow.addButton("I'm not hungry", () => {
	SnakesWords = "Oh...thats a shame...";
	setTimeout( () => {isHunger = true;hungerWindow.toggleVisibility("visible");}, 8000);
	
	SnakeWindow.setButtonVisibility(2, false);
},2);

SnakeWindow.setButtonVisibility(2, false);


let ForbiddenFruitWindow = new ContextWindow("Forbidden Fruit", window.innerWidth/8, window.innerHeight/5);
ForbiddenFruitWindow.setText("<pre> <br>"+
"                                                         <br>"+
"                           ~]()<)))))([.                 <br>"+
"                       -[))][[[[[])(]())<(               <br>"+
"                    .]([[[}}[[[[]](((()()(<] .)*         <br>"+
"                   [][}}}}}}}}}](())))(]])))(]])+  .*:   <br>"+
"                  }[[}}}}}}}}}()><))]](]]}]<^[%#%%[](    <br>"+
"                 [}}{}}}}}[[](<^^<)}}}}[}[[#[)#{%#%:     <br>"+
"                }{}}}}{{{{}}()>><<]}}}}{{{##%%@[@@{])<*  <br>"+
"               :}}{{{{{{{}}[)()>)(}}}}}{{#%%%#^@%@%()[]: <br>"+
"               <}{{{{{{{{}}}}])(((]}{}}}{{{##{^*%%#)^    <br>"+
"               [{{{{}{{}{}}}}{}()<>(}{{{{{{{#%##{)=  [   <br>"+
"       @@{%@%  #]}{{{{{{{{}{}}}}}<<)}}{{{{}{{{{((>(      <br>"+
"       %{%}>{#[#@>[@[}%{{{}{}}}}}}}<^<}{{}}}}}}}}}{>=     <br>"+
" ]-:.({]#{%}}}{}[(~~-){][<[#{{}{}}}{<)}}{}}}}}}}}}[*     <br>"+
" )-.:}[[}#%}%}{{}%#{~~~--[[}[(#}{{{{{{})}}[]}}}}}}}*     <br>"+
" ]-:)}#%{}[##%%+{{[[#{})([[^..:>{[>#%}}}}[]][[[}}}#      <br>"+
" :<::%}#%#@%#%{%{###}##{{}{*~<{{{[}{{}}}}}[[[[[[[}^      <br>"+
"  [~.}#}#@[}{@{}[<{%#{#@%##*+}{{}[}#{{{}}}}}}}}}[#       <br>"+
"  .]~:}#[}#%%}}@}><}}#@([}{+#}}[}#{{{{{{{}}}}}}}[        <br>"+
"   .#---+}[%%([{@@%##{]{{{)[}{}###{{###{{{{{{{#-         <br>"+
"     ({--~}]>%%%%}}#[%}[}>}}}#############{{#-           <br>"+
" <{}]  )%=~){}}#{#{}]+{{#}{#@############}-              <br>"+
" }[[]}{(<{}}{*+=:.<}}+#{[         ..                     <br>"+
"<br>"+
"</pre>");
ForbiddenFruitWindow.addButton("Eat", () => {console.log("God is vewy vewy angwy")});
ForbiddenFruitWindow.toggleVisibility("hidden");

let hunger = 1000;
let isHunger = false;
let hungerWindow = new ContextWindow("Hunger", window.innerWidth/1.2, 0);
hungerWindow.toggleVisibility("hidden");

let hungerInterval = setInterval(() => {hungerWindow.setText("Hunger: " + hunger)}, 128);
let entropy = setInterval(() => {
   if(isHunger){
   hunger--;
   };
}, 100);

	</script>
</body>
</html>
